Данный проект реализует систему управления двумя семисегментными индикаторами через каскадное соединение сдвиговых регистров **74HC595**. Система функционирует как секундомер с диапазоном от **00** до **99**, обновляемый ровно раз в секунду.

Ключевой особенностью реализации является **полностью неблокирующая архитектура**. Все операции по отсчету времени, формированию сигнала и выводу данных на регистры выполняются внутри аппаратных прерываний таймера (**Timer1**). Основной цикл программы (`loop`) свободен от задач индикации и занят только обработкой пользовательского ввода через Serial-порт.

## Ключевые особенности решения

*   **Аппаратный тайминг:** Использование `Timer1` в режиме CTC (Clear Timer on Compare Match) для генерации прерываний с частотой ровно 1 Гц. Это обеспечивает высокую точность хода секундомера.
*   **Прямое управление портами:** Для управления пинами (Data, Clock, Latch) используется прямая запись в регистр `PORTD` микроконтроллера. Это значительно быстрее стандартных функций `digitalWrite` и `shiftOut`, а также демонстрирует понимание низкоуровневой работы MCU.
*   **Отсутствие `delay()`:** В коде не используются функции задержки, останавливающие процессор.
*   **Интерактивное управление:** Пользователь может задать текущее значение секунд через Serial Monitor в любой момент времени.
*   **Универсальность:** Поддержка индикаторов как с общим анодом, так и с общим катодом (настраивается в коде).

## Схема подключения

### Компоненты
*   Arduino Uno (или совместимая плата на базе ATmega328P)
*   2x Сдвиговый регистр 74HC595 (8-бит)
*   2x Семисегментный индикатор (1 цифра)
*   16x Токоограничивающих резисторов (220 Ом - 330 Ом)

### Распиновка

Управление осуществляется через порт D микроконтроллера:

| Функция | Пин Arduino | Пин PORTD | Пин 74HC595 | Описание |
| :--- | :--- | :--- | :--- | :--- |
| **DATA (DS)** | **D7** | PD7 | Pin 14 (Reg 1) | Вход данных первого регистра |
| **CLOCK (SHCP)** | **D3** | PD3 | Pin 11 (Both) | Тактовый сигнал (общий) |
| **LATCH (STCP)** | **D5** | PD5 | Pin 12 (Both) | Сигнал защелки (общий) |

**Каскадное соединение:**
1.  Выход переполнения **Q7' (Pin 9)** первого регистра подключается ко входу **DS (Pin 14)** второго регистра.
2.  Первый регистр управляет **десятками**.
3.  Второй регистр управляет **единицами**.

**Питание 74HC595:**
*   VCC (Pin 16) -> 5V
*   GND (Pin 8) -> GND
*   MR (Pin 10) -> 5V (Сброс не активен)
*   OE (Pin 13) -> GND (Выходы включены)

## Установка и Запуск

1.  **Загрузка прошивки:**
    Откройте проект в Arduino IDE или PlatformIO и загрузите код в плату.

2.  **Работа с устройством:**
    *   После загрузки на индикаторах начнется автоматический отсчет (00 -> 01 -> ...).
    *   Откройте **Монитор порта (Serial Monitor)** на скорости **9600 бод**.
    *   Введите двузначное число (например, `45`) и нажмите Enter.
    *   В момент следующего тика таймера значение счетчика изменится на введенное вами.

## Принцип работы кода

### 1. Таймер (Timer1)
Таймер настроен на частоту 1 Гц.
*   Предделитель: 64
*   Режим: CTC
*   Значение регистра сравнения (`OCR1A`): 249 (для 16 МГц кварца, период прерывания 1 мс).

### 2. Прерывание (ISR)
Функция `ISR(TIMER1_COMPA_vect)` вызывается каждую миллисекунду, но обновление счетчика происходит раз в секунду (через 1000 вызовов):
1.  **Обновление логики:** Проверяет флаг `next_value`. Если пришли данные из Serial — применяет их, иначе просто увеличивает счетчик.
2.  **Кодирование:** Разбивает число на десятки и единицы, преобразует их в битовые паттерны для сегментов (по массиву `segment_patterns`).
3.  **Сдвиг данных:** Используя прямое управление портами, биты последовательно отправляются в регистры. Сначала отправляются биты для **единиц** (они пройдут сквозь первый регистр во второй), затем биты для **десятков** (останутся в первом).
4.  **Защелкивание:** Подается импульс на пин Latch, обновляя изображение на индикаторах мгновенно.

### 3. Главный цикл (Loop)
Цикл занимается исключительно чтением данных из `Serial`. При получении валидного числа (0-99), оно записывается в переменную `next_value`, и поднимается флаг для прерывания. Это гарантирует атомарность и безопасность данных.

*   [Ссылка на проект в Tinkercad](https://www.tinkercad.com/things/50J7SPnNFHs-shiftregistrerstimers)