
Данный проект реализует драйвер для матричной клавиатуры 3x3 (на основе ползунковых переключателей для симуляции одновременных нажатий) на микроконтроллере ATmega328P (Arduino Uno).

### Функциональность
1.  **Сканирование матрицы:** Используется Timer1 для периодического вызова прерывания, в котором происходит опрос состояния кнопок построчно.
2.  **Детектирование событий:** Система отслеживает изменение состояния кнопок. Сообщение в Serial Monitor выводится только при изменении (нажатие или отпускание).
3.  **Логирование:** При любом изменении выводится полный список текущих нажатых кнопок.
4.  **Учет времени:** При отпускании кнопки выводится длительность её удержания и время начала нажатия (в миллисекундах).

## Аппаратная конфигурация
Схема собрана на Arduino Uno.

### Подключение (Port D)
*   **Строки (Rows) - Выходы:**
    *   Row 1: Pin 2 (PD2)
    *   Row 2: Pin 3 (PD3)
    *   Row 3: Pin 4 (PD4)
*   **Столбцы (Cols) - Входы (Input Pull-up):**
    *   Col 1: Pin 5 (PD5)
    *   Col 2: Pin 6 (PD6)
    *   Col 3: Pin 7 (PD7)

## Реализация кода

### Работа с регистрами (Задача 0a)
Вместо `pinMode` и `digitalWrite` используются регистры `DDRD`, `PORTD` и `PIND`.
*   Маска строк: Биты 2, 3, 4.
*   Маска столбцов: Биты 5, 6, 7.
    Чтение состояния осуществляется за одну операцию чтения регистра `PIND` и наложения битовой маски.

### Таймеры (Задача 0b)
Настроен таймер **Timer1** в режиме CTC (Clear Timer on Compare Match).
*   Частота прерываний настроена так, чтобы опрос одной строки происходил каждые ~4 мс.
*   Полный цикл обновления всей матрицы (3 строки) занимает ~12 мс, что обеспечивает отличное подавление дребезга и отзывчивость.

### Логика вывода
Основной цикл `loop()` не занимается опросом "железа". Он проверяет флаг изменения состояния (`state_changed`), который устанавливается в прерывании (или при сравнении буферов), и формирует вывод в UART. Это разделяет логику сбора данных (real-time) и логику интерфейса (slow I/O).

[Cимуляцию в Tinkercad](https://www.tinkercad.com/things/6kBA13Zl0Uj-buttonmatrix)
